% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sample_confidence.R
\name{sample_confidence}
\alias{sample_confidence}
\title{Sample Detections Across Confidence Range for Validation}
\usage{
sample_confidence(
  birdnet_results,
  n_samples = 100,
  n_bins = 10,
  fill_target = TRUE,
  species = NULL,
  species_column = "scientific_name",
  create_clips = FALSE,
  output_dir = NULL,
  input_format = "kaleidoscope",
  output_format = "kaleidoscope",
  seed = NULL,
  min_conf = 0.1,
  max_conf = 1,
  verbose = FALSE,
  ...
)
}
\arguments{
\item{birdnet_results}{Character or data.frame. Either a path to a BirdNET detection file or a data frame containing BirdNET detections.}

\item{n_samples}{Integer. Target number of samples to select per species (default: 100)}

\item{n_bins}{Integer. Number of confidence bins to create for stratified sampling (default: 10)}

\item{fill_target}{Logical. If TRUE, fill remaining slots from other bins to reach n_samples when bins are uneven. If FALSE, return equal samples per bin (may be fewer than n_samples) (default: TRUE)}

\item{species}{Character vector. Species name(s) of interest. If NULL, all species in the data will be processed. (default: NULL)}

\item{species_column}{Character. Column name containing the species names. (default: "scientific_name")}

\item{create_clips}{Logical. If TRUE, create validation audio clips using create_validation_data (default: FALSE)}

\item{output_dir}{Character. Output directory for clips (required if create_clips = TRUE)}

\item{input_format}{Character. Format of input data. Currently only "kaleidoscope" is supported (default: "kaleidoscope")}

\item{output_format}{Character. Format of output CSV. Currently only "kaleidoscope" is supported (default: "kaleidoscope")}

\item{seed}{Integer. Random seed for reproducible sampling (default: NULL)}

\item{min_conf}{Numeric. Minimum confidence threshold to include (default: 0.1)}

\item{max_conf}{Numeric. Maximum confidence threshold to include (default: 1.0)}

\item{verbose}{Logical. If TRUE, show progress messages during processing (default: FALSE)}

\item{...}{Additional arguments passed to create_validation_data()}
}
\value{
A list containing:
\itemize{
\item sampled_data: Data frame of sampled detections from all processed species
\item validation_path: Path to validation files (if create_clips = TRUE, NULL otherwise)
}
}
\description{
This function samples a specified number of detections evenly across confidence
ranges for each species and optionally creates validation audio clips. It supports
BirdNET-Analyzer compatible formats and uses stratified sampling across confidence bins.
}
\details{
This function performs stratified sampling across confidence score ranges to ensure
representation across the full confidence spectrum for each species separately.

\strong{Sampling Strategy:}
\itemize{
\item Confidence scores are divided into n_bins equal-width bins based on the full dataset range
\item Each species is sampled separately using the same bin structure
\item If fill_target = TRUE: Target n_samples per species, resampling from populated bins if needed
\item If fill_target = FALSE: Equal samples per bin per species, total may be less than n_samples
\item All species results are combined into a single output dataset
}

\strong{Multi-Species Processing:}
\itemize{
\item When species = NULL, all species in the dataset are processed
\item Each species gets up to n_samples detections
\item Final dataset contains samples from all species combined
}

\strong{Input Requirements:}
\itemize{
\item Data must contain a column with 'confidence' in the name (case-insensitive)
\item Data must contain the specified species_column
\item Currently only supports Kaleidoscope format
}
}
\examples{
\dontrun{
# Sample 50 detections per species across confidence range, create clips
result <- sample_confidence(
  birdnet_results = "birdnet_detections.csv",
  n_samples = 50,
  n_bins = 5,
  create_clips = TRUE,
  output_dir = "validation_clips"
)

# Sample specific species without resampling, no clips
result <- sample_confidence(
  birdnet_results = "detections.csv",
  species = c("Turdus migratorius", "Corvus brachyrhynchos"),
  n_samples = 100,
  fill_target = FALSE,
  create_clips = FALSE
)

}

}
